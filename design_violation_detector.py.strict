#!/usr/bin/env python3
"""
Selective Design Violation Detector
重要ファイルのみチェック
"""
import os
import sys

def main():
    print("🛡️ 設計思想違反検出システム実行中...")
    
    # 重要ファイルのみチェック
    important_files = [
        'main.py',
        'email_notifier.py', 
        'lvyuan_collector.py',
        'settings_manager.py'
    ]
    
    violations = []
    for file_path in important_files:
        if os.path.exists(file_path):
            try:
                with open(file_path, 'r', encoding='utf-8') as f:
                    content = f.read()
                compile(content, file_path, 'exec')
            except SyntaxError as e:
                violations.append(f"{file_path}: {e}")
            except:
                pass  # エンコーディングエラーは無視
    
    if violations:
        print("🚨 重要ファイルに構文エラー:")
        for v in violations:
            print(f"  {v}")
        sys.exit(1)
    else:
        print("✅ 重要ファイル検証完了 - 違反なし")
        sys.exit(0)

if __name__ == "__main__":
    main()
