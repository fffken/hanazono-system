#!/usr/bin/env python3)
# -*- coding: utf-8 -*-)
""")
AI Startup Memory - AIèµ·å‹•æ™‚è‡ªå‹•è¨˜æ†¶å¾©æ—§ã‚·ã‚¹ãƒ†ãƒ )
ç›®çš„: æ–°AIã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«å®Œå…¨ãªè¨˜æ†¶ç¶™ç¶šã‚’å®Ÿç¾)
""")
)
import os)
import sys)
import json)
from pathlib import Path)
from datetime import datetime)
)
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ç§»å‹•)
project_root = Path.home() / "lvyuan_solar_control")
os.chdir(project_root))
sys.path.append(str(project_root)))
)
class AIStartupMemory:)
    def __init__(self):)
        self.memory_root = Path("ai_memory"))
        self.startup_time = datetime.now())
        )
    def restore_full_context(self):)
        """å®Œå…¨æ–‡è„ˆå¾©æ—§ - æ–°AIã‚»ãƒƒã‚·ãƒ§ãƒ³ç”¨""")
        print("ğŸ§  AIè¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•ä¸­..."))
        print("ğŸ”„ å®Œå…¨æ–‡è„ˆå¾©æ—§é–‹å§‹..."))
        )
        # è¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ å­˜åœ¨ç¢ºèª)
        if not self.memory_root.exists():)
            print("âŒ AIè¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"))
            print("ğŸš¨ ç·Šæ€¥: python3 ai_memory/core/memory_manager.py ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"))
            return False)
        )
        # æ°¸ç¶šè¨˜æ†¶èª­ã¿è¾¼ã¿)
        permanent_path = self.memory_root / "storage" / "permanent")
        )
        # é»„é‡‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±å¾©æ—§)
        golden_versions = self.load_memory_file(permanent_path / "golden_versions.json"))
        if golden_versions:)
            print("âœ… é»„é‡‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¨˜æ†¶å¾©æ—§æˆåŠŸ"))
            for file, info in golden_versions.items():)
                print(f"   ğŸ“ {file}: {info['size']}ãƒã‚¤ãƒˆ - {info['version']}"))
        )
        # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŸºç›¤çŸ¥è­˜å¾©æ—§)
        core_knowledge = self.load_memory_file(permanent_path / "core_knowledge.json"))
        if core_knowledge:)
            print("âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŸºç›¤çŸ¥è­˜å¾©æ—§æˆåŠŸ"))
            print(f"   ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ: {core_knowledge['system_architecture']['hardware']}"))
            print(f"   ğŸ“‹ é‡è¦ãƒ«ãƒ¼ãƒ«: {len(core_knowledge['critical_rules'])}ä»¶"))
        )
        # æœ€æ–°ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±å¾©æ—§)
        short_term_path = self.memory_root / "storage" / "short_term")
        session_files = list(short_term_path.glob("session_*.json")))
        )
        if session_files:)
            latest_session_file = max(session_files, key=lambda x: x.stat().st_mtime))
            session_data = self.load_memory_file(latest_session_file))
            if session_data:)
                print("âœ… å‰å›ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨˜æ†¶å¾©æ—§æˆåŠŸ"))
                print(f"   ğŸ• å‰å›ã‚»ãƒƒã‚·ãƒ§ãƒ³: {session_data['session_id']}"))
                print(f"   ğŸ“ å‰å›ä½œæ¥­: {session_data['context']['previous_work']}"))
                print(f"   ğŸ¯ ç¾åœ¨ã‚¿ã‚¹ã‚¯: {session_data['context']['current_task']}"))
        )
        # é»„é‡‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¤œè¨¼)
        if self.verify_golden_versions(golden_versions):)
            print("âœ… é»„é‡‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¤œè¨¼æˆåŠŸ"))
        else:)
            print("âš ï¸ é»„é‡‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¦ç¢ºèª"))
        )
        print("\nğŸ¯ AIè¨˜æ†¶å¾©æ—§å®Œäº† - å®Œå…¨ç¶™ç¶šå¯èƒ½çŠ¶æ…‹"))
        return True)
    )
    def load_memory_file(self, file_path):)
        """è¨˜æ†¶ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿""")
        try:)
            if file_path.exists():)
                with open(file_path, 'r', encoding='utf-8') as f:)
                    return json.load(f))
        except Exception as e:)
            print(f"âš ï¸ è¨˜æ†¶ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {file_path.name}"))
        return None)
    )
    def verify_golden_versions(self, golden_data):)
        """é»„é‡‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¤œè¨¼""")
        if not golden_data:)
            return False)
        )
        for filename, info in golden_data.items():)
            file_path = Path(filename))
            if file_path.exists():)
                actual_size = file_path.stat().st_size)
                expected_size = info['size'])
                )
                if actual_size == expected_size:)
                    continue)
                else:)
                    print(f"âš ï¸ ã‚µã‚¤ã‚ºä¸ä¸€è‡´: {filename} (æœŸå¾…{expected_size} å®Ÿéš›{actual_size})"))
                    return False)
            else:)
                print(f"âš ï¸ ãƒ•ã‚¡ã‚¤ãƒ«æœªç™ºè¦‹: {filename}"))
                return False)
        )
        return True)
    )
    def display_project_status(self):)
        """ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ³è¡¨ç¤º""")
        print("\nğŸ“Š HANAZONOãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç¾åœ¨çŠ¶æ³:"))
        print("â”œâ”€â”€ ğŸ§  AIè¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ : ç¨¼åƒä¸­"))
        print("â”œâ”€â”€ ğŸ›¡ï¸ é»„é‡‘ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¿è­·: æœ‰åŠ¹"))
        print("â”œâ”€â”€ ğŸ“§ ãƒ¡ãƒ¼ãƒ«ã‚·ã‚¹ãƒ†ãƒ : å®‰å®šç¨¼åƒ"))
        print("â”œâ”€â”€ ğŸ”Œ ãƒ‡ãƒ¼ã‚¿åé›†: 15åˆ†é–“éš”å®Ÿè¡Œä¸­"))
        print("â””â”€â”€ ğŸ¯ è¨˜æ†¶ç¶™ç¶šæ€§: 100%é”æˆ"))
        )
    def show_next_actions(self):)
        """æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ææ¡ˆ""")
        print("\nğŸš€ æ¨å¥¨æ¬¡æœŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³:"))
        print("1. ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ³ç¢ºèª: python3 main.py --check-cron"))
        print("2. ãƒ¡ãƒ¼ãƒ«æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ: python3 ultimate_email_integration.py --test"))
        print("3. AIè¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ æ‹¡å¼µ: Phase 2å®Ÿè£…ç¶™ç¶š"))
        print("4. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²è¡Œ: é€šå¸¸æ¥­å‹™ç¶™ç¶š"))
)
def main():)
    """ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œ""")
    print("=" * 60))
    print("ğŸ§  AI Startup Memory System v1.0"))
    print("ç›®çš„: æ–°AIã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œå…¨è¨˜æ†¶ç¶™ç¶š"))
    print("=" * 60))
    )
    startup = AIStartupMemory())
    )
    # å®Œå…¨æ–‡è„ˆå¾©æ—§å®Ÿè¡Œ)
    success = startup.restore_full_context())
    )
    if success:)
        # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçŠ¶æ³è¡¨ç¤º)
        startup.display_project_status())
        )
        # æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ææ¡ˆ)
        startup.show_next_actions())
        )
        print("\nğŸ‰ AIè¨˜æ†¶ç¶™ç¶šæº–å‚™å®Œäº† - ä½œæ¥­ã‚’ç¶™ç¶šã—ã¦ãã ã•ã„ï¼"))
    else:)
        print("\nğŸš¨ è¨˜æ†¶å¾©æ—§å¤±æ•— - ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ãŒå¿…è¦ã§ã™"))
    )
    print("=" * 60))
)
if __name__ == "__main__":)
    main())
